<!DOCTYPE html>
<html>
<head>
    <title>TimeLine</title>

    <script type="text/javascript" src="https://rally1.rallydev.com/apps/2.1/sdk.js"></script>

    <script type="text/javascript">
        Rally.onReady(function () {
                Ext.define("nantonelliTimeLineApp",{extend:"Rally.app.App",componentCls:"app",id:"MyApp",paleColours:["#E4EECF","#E6E6E6","#BDD7EA","#FFEDBF","#6ab17d","#F1C5DD","#C3E9E3"],inheritableStatics:{ErrorColour:Rally.util.Colors.red_med,WarnColour:Rally.util.Colors.yellow,PassColour:Rally.util.Colors.lime,DoneColour:"silver",ToDoColour:Rally.util.Colors.cyan_very_lt,HdrColour:"lightgray",DataError:"red",DaysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],ChildBoxWidth:300,ParentBoxWidth:200,TimeLineBarHeight:30,HeaderBoxHeight:15,TypeFieldName:"c_Type"},items:[{xtype:"container",layout:"hbox",items:[{xtype:"container",id:"headerBox",flex:1,layout:"hbox",items:[{xtype:"rallydatefield",margin:10,format:"D d M Y",id:"StartDate",stateful:!0,fieldLabel:"Start Date",value:Ext.Date.subtract(new Date,Ext.Date.DAY,90)},{xtype:"rallydatefield",margin:10,fieldLabel:"End Date",format:"D d M Y",stateful:!0,id:"EndDate",value:new Date}]},{xtype:"container",layout:"hbox",margin:10,items:[{xtype:"rallybuttonslider",labelText:"Zoom",id:"zoomSlider",stateful:!0,value:10}]}]}],getSettingsFields:function(){return[{xtype:"rallycheckboxfield",name:"percentageType",fieldLabel:"Use story points for percentages",stateful:!0,stateId:"percent-"+Ext.id(),labelAlign:"right",labelWidth:200},{xtype:"rallycheckboxfield",name:"displayIterations",fieldLabel:"Display Iteration Header",stateful:!0,stateId:"dispIters-"+Ext.id(),labelAlign:"right",labelWidth:200},{xtype:"rallycheckboxfield",name:"displayReleases",fieldLabel:"Display Release Header",stateful:!0,stateId:"dispRels-"+Ext.id(),labelAlign:"right",labelWidth:200},{xtype:"rallycheckboxfield",name:"updateForRelease",fieldLabel:"Auto update to Release",stateful:!0,stateId:"dduRels-"+Ext.id(),labelAlign:"right",labelWidth:200},{xtype:"rallycheckboxfield",name:"groupByParent",fieldLabel:"Group Portfolio Items",stateful:!0,stateId:"groupByPs-"+Ext.id(),labelAlign:"right",labelWidth:200},{xtype:"rallycheckboxfield",name:"enableOutOfDateRange",fieldLabel:"Enable Out of Range Dates",stateful:!0,stateId:"enablr-"+Ext.id(),labelAlign:"right",labelWidth:200},{xtype:"textarea",fieldLabel:"Query",name:"query",anchor:"100%",cls:"query-field",margin:"0 70 0 0",plugins:[{ptype:"rallyhelpfield",helpId:194},"rallyfieldvalidationui"],validateOnBlur:!1,validateOnChange:!1,validator:function(e){try{return e&&Rally.data.wsapi.Filter.fromQueryString(e),!0}catch(e){return e.message}}}]},zoomLevel:1,_resetTreeBox:function(e){var t=Ext.getCmp("treeBox"),a=Ext.getCmp("parentBox");e._destroyBars(t.id),t.add(e._createBar({title:"Calendar Month:",colour:nantonelliTimeLineApp.HdrColour,width:"100%",margin:"0 0 10 0",height:nantonelliTimeLineApp.HeaderBoxHeight,align:"right"})),a&&(e._destroyBars(a.id),a.add(e._createBar({colour:nantonelliTimeLineApp.HdrColour,width:"100%",margin:"0 0 10 0",height:nantonelliTimeLineApp.HeaderBoxHeight,align:"right"})))},_destroyBars:function(e){var t=Ext.getCmp(e);t&&t.removeAll()},_resizeAllBars:function(){this._redrawTimeLines(this,Ext.getCmp("piType").getRecord().get("TypePath"))},_addTipInfo:function(e,t){var a=e.record,i="";return _.each(t,function(e){Object.prototype.toString.call(a.get(e.field)).search("Date")?i+="<div><strong>"+e.text+": </strong>"+Ext.Date.format(a.get(e.field),"D d M Y (T)")+"</div>":i+="<div><strong>"+e.text+": </strong>"+a.get(e.field)+"</div>"}),i.length>0?i:null},_renderTimeboxes:function(){this._iterationRender(),this._releaseRender()},_iterationRender:function(){if(this.getSetting("displayIterations")){var e=Ext.getCmp("treeBox"),t=this._createBar({width:"100%",height:nantonelliTimeLineApp.HeaderBoxHeight,title:"Sprint: ",colour:nantonelliTimeLineApp.HdrColour,align:"right"});e.insert(0,t);var a=Ext.getCmp("parentBox");if(a){var i=this._createBar({width:"100%",height:nantonelliTimeLineApp.HeaderBoxHeight,title:"",colour:nantonelliTimeLineApp.HdrColour,align:"right"});a.insert(0,i)}this._timeboxRender("iteration","StartDate","EndDate","Sprint: ",[{text:"Iteration Start Date",field:"StartDate"},{text:"Iteration End Date",field:"EndDate"}])}},_releaseRender:function(){if(this.getSetting("displayReleases")){var e="Program Increment: ",t=Ext.getCmp("treeBox"),a=this._createBar({width:"100%",height:nantonelliTimeLineApp.HeaderBoxHeight,title:e,colour:nantonelliTimeLineApp.HdrColour,align:"right"});t.insert(0,a);var i=Ext.getCmp("parentBox");if(i){var n=this._createBar({width:"100%",height:nantonelliTimeLineApp.HeaderBoxHeight,title:"",colour:nantonelliTimeLineApp.HdrColour,align:"right"});i.insert(0,n)}this._timeboxRender("release","ReleaseStartDate","ReleaseDate",e,[{text:"Release Start Date",field:"ReleaseStartDate"},{text:"Release End Date",field:"ReleaseDate"}])}},_timeboxRender:function(e,t,a,i,n){var r=this;Ext.create("Rally.data.wsapi.Store",{model:e,autoLoad:!0,context:{project:Rally.environment.getContext().getProjectRef(),projectScopeUp:!1,projectScopeDown:!1},sorters:[{property:a,direction:"ASC"}],listeners:{load:function(i,l,o){var s=Ext.getCmp(e+"Box"),d=[],p=l[0].get(t);if(p>stats.start){var g={width:Ext.Date.getElapsed(p,stats.start)*stats.pixelsPerDay/864e5,start:stats.start,leftMargin:0,end:p,colour:nantonelliTimeLineApp.ToDoColour,height:nantonelliTimeLineApp.HeaderBoxHeight};d.push(g)}_.each(l,function(e){var i=Ext.Date.clearTime(e.get(t)),l=Ext.Date.clearTime(Ext.Date.add(e.get(a),Ext.Date.HOUR,1));if((lastBox=d[d.length-1])&&lastBox.end!=i){var o={width:Ext.Date.getElapsed(lastBox.end,i)*stats.pixelsPerDay/864e5,start:lastBox.end,leftMargin:0,end:i,colour:nantonelliTimeLineApp.ToDoColour,height:nantonelliTimeLineApp.HeaderBoxHeight};d.push(o)}var s={width:Ext.Date.getElapsed(l,i)*stats.pixelsPerDay/864e5,leftMargin:0,start:i,end:l,colour:nantonelliTimeLineApp.HdrColour,title:e.get("Name"),height:nantonelliTimeLineApp.HeaderBoxHeight,record:e};s.tooltip=r._addTipInfo(s,n),d.push(s)});var u=d[d.length-1].end;if(u<stats.end){var c={width:Ext.Date.getElapsed(u,stats.end)*stats.pixelsPerDay/864e5,start:u,leftMargin:0,end:stats.end,colour:nantonelliTimeLineApp.ToDoColour,height:nantonelliTimeLineApp.HeaderBoxHeight};d.push(c)}_.each(d,function(e){if(!(e.end<stats.start||e.start>stats.end)){e.start<stats.start&&(e.start=stats.start,e.start>=e.end?e.width=0:e.width=Ext.Date.getElapsed(e.end,e.start)*stats.pixelsPerDay/864e5),e.end>stats.end&&(e.end=stats.end,e.end<=e.start?e.width=0:e.width=Ext.Date.getElapsed(e.end,e.start)*stats.pixelsPerDay/864e5);var t=r._createBar(e);t.addCls("mnthBox"),t.addCls("tltBox"),s.add(t)}})}}})},launch:function(){var e=this,t=Ext.getCmp("zoomSlider"),a=t.getLeftButton(),i=t.getRightButton(),n=t.getSlider();i.on("click",function(){e.zoomLevel+=1,e.zoomLevel>10&&(e.zoomLevel=10),n.setValue(10*e.zoomLevel),e._redrawTimeLines(e,Ext.getCmp("piType").getRecord().get("TypePath"))}),a.on("click",function(){e.zoomLevel-=1,e.zoomLevel<=0&&(e.zoomLevel=1),n.setValue(10*e.zoomLevel),e._redrawTimeLines(e,Ext.getCmp("piType").getRecord().get("TypePath"))}),n.on("changecomplete",function(t,a,i){e.zoomLevel=Math.trunc(a/10),e._redrawTimeLines(e,Ext.getCmp("piType").getRecord().get("TypePath"))}),Ext.getCmp("StartDate").on("select",e._resizeAllBars,e),Ext.getCmp("EndDate").on("select",e._resizeAllBars,e);var r=[{xtype:"container",id:"treeBox",width:this.self.ChildBoxWidth-4,margin:"0 0 0 0"},{xtype:"container",id:"scrollBox",layout:"vbox",items:[{xtype:"container",id:"releaseBox",layout:"hbox"},{xtype:"container",id:"iterationBox",layout:"hbox"},{xtype:"container",id:"monthBox",layout:"hbox"},{xtype:"container",autoSize:!0,id:"lineBox"}],flex:1,style:{overflowX:"scroll",overflowY:"visible"}}];e.getSetting("groupByParent")&&r.splice(0,0,{xtype:"container",id:"parentBox",width:this.self.ParentBoxWidth-4,margin:"0 0 0 0"});var l=Ext.create("Ext.container.Container",{layout:"hbox",items:r});this.add(l),Rally.data.ModelFactory.getModel({type:"Milestone",context:e.getContext().getDataContext(),success:function(t){if(t.hasField(nantonelliTimeLineApp.TypeFieldName)){var a=t.getField(nantonelliTimeLineApp.TypeFieldName);"COLLECTION"===a.attributeDefinition.AttributeType&&!0===a.attributeDefinition.Constrained&&!1===a.hidden&&t.getField(nantonelliTimeLineApp.TypeFieldName).getAllowedValueStore({filters:[{property:"StringValue",operator:"!=",value:null}]}).load().then({success:function(t){e.down("#headerBox").add({fieldLabel:"Show Milestone Type",id:"milestoneTypes",labelWidth:150,xtype:"rallycombobox",margin:10,multiSelect:!0,displayField:"StringValue",valueField:"StringValue",allowBlank:!0,allowClear:!1,store:t[0].stores[0],listeners:{change:function(t,a){e._addLines()},scope:e}})},failure:function(e){console.log("Could not get Type field data on Milestones",e)}})}}});var o=Ext.getCmp("piType");o||(o=Ext.create("Rally.ui.combobox.PortfolioItemTypeComboBox",{margin:10,id:"piType",listeners:{select:function(){e._redrawTimeLines(e,Ext.getCmp("piType").getRecord().get("TypePath"))}}})),Ext.getCmp("headerBox").insert(0,o)},onTimeboxScopeChange:function(e){this.callParent(arguments);var t=this;if("release"==e.type){var a=e.getRecord();this.getSetting("updateForRelease")?(Ext.getCmp("StartDate").setValue(a.get("ReleaseStartDate")),Ext.getCmp("EndDate").setValue(a.get("ReleaseDate")),t._redrawTimeLines(t,Ext.getCmp("piType").getRecord().get("TypePath"))):Ext.create("Rally.ui.dialog.ConfirmDialog",{message:"Update view dates to match Release?",title:"Timebox Scope Change Request",confirmLabel:"Ok",listeners:{confirm:function(){Ext.getCmp("StartDate").setValue(a.get("ReleaseStartDate")),Ext.getCmp("EndDate").setValue(a.get("ReleaseDate")),t._redrawTimeLines(t,Ext.getCmp("piType").getRecord().get("TypePath"))},cancel:function(){t._redrawTimeLines(t,Ext.getCmp("piType").getRecord().get("TypePath"))}}})}},_dataCheckItem:function(e,t,a){var i=!1,n="";a.self.isPortfolioItem()&&(a.get("PlannedStartDate")||(i=!0,n+="<div><strong> Missing Planned Start Date</strong></div>"),a.get("PlannedEndDate")||(i=!0,n+="<div><strong> Missing Planned End Date</strong></div>")),i&&(t.addCls("errorCorner"),t.tooltip=n)},_milestoneColours:["green","blue","brown","purple","olive","fuchsia","lime","maroon"],_fetchMilestones:function(){var e=Ext.create("Deft.Deferred");if(this._milestoneStore)return e.resolve(this._milestoneStore.getRecords()),e.promise;var t=Rally.data.wsapi.Filter.or([{property:"Projects.ObjectID",value:this.getContext().getProject().ObjectID},{property:"Projects.ObjectID",value:null}]),a=this;return Ext.create("Rally.data.wsapi.Store",{model:"Milestone",autoLoad:!1,fetch:!0,filters:t,listeners:{load:function(t,i,n){n?t.getRecords().length&&n?(a._milestoneStore=t,e.resolve(i)):e.resolve(null):console.log("Oh de bugger!")}}}).load(),e.promise},_applyMilestoneFilter:function(){var e=this;if(Ext.getCmp("milestoneTypes")){var t=Ext.getCmp("milestoneTypes").value;return _.filter(e._milestoneStore.getRecords(),function(a){return _.find(a.get(e.self.TypeFieldName)._tagsNameArray,function(e){return _.find(t,function(t){return e.Name===t})})})}return[]},_addMilestones:function(){var e=this;this._fetchMilestones().then({success:function(){e._undrawMilestones(),e._drawMilestones(e._applyMilestoneFilter())},scope:e})},_undrawMilestones:function(){Ext.getCmp("milestoneBox").removeAll(),this._addLine("Today",new Date,"today")},_drawMilestones:function(e){var t=this;_.each(e,function(e){var a=e.get("Projects").Count?"projectMls":"globalMls";t._addLine(e.get("Name"),e.get("TargetDate"),a).getEl().setStyle({borderColor:e.get("DisplayColor").length?e.get("DisplayColor"):"#000000"})})},_addLine:function(e,t,a){var i=Ext.getCmp("milestoneBox");return thisLine=Ext.create("Ext.container.Container",{height:Ext.getCmp("lineBox").getHeight(),width:"2px",cls:"overlayLine",margin:"0 0 0 "+Ext.Date.getElapsed(stats.start,t)*stats.pixelsPerDay/864e5}),thisLine.addCls(a+"Line"),i.add(thisLine),thisIcon=Ext.create("Ext.container.Container",{height:"10px",width:"10px",cls:"overlayLine",margin:"0 0 0 "+(Ext.Date.getElapsed(stats.start,t)*stats.pixelsPerDay/864e5-4),listeners:{afterrender:function(){Ext.create("Rally.ui.tooltip.ToolTip",{target:this.getEl(),html:e+": "+Ext.Date.format(t,"D, d M Y")})}}}),thisIcon.addCls(a+"Icon"),i.add(thisIcon),thisLine},_redrawTimeLines:function(e,t){var a=[],i=e.getContext().getTimeboxScope();i&&a.push(i.getQueryFilter());var n=e.getSetting("query");if(n){var r=Rally.data.wsapi.Filter.fromQueryString(n);r.itemId=r.toString(),a.push(r)}var l=null;l=e.getSetting("groupByParent")?{property:"Parent",direction:"ASC"}:{property:"rank",direction:"ASC"};var o=Ext.create("Rally.data.wsapi.Filter",{property:"Archived",operator:"=",value:!1});a.push(o);Ext.create("Rally.data.wsapi.Store",{model:t,autoLoad:!0,filters:a,sorters:[l],listeners:{load:function(t,a,i){0===t.getRecords().length&&Rally.ui.notify.Notifier.showWarning({message:"No items of selected type found"}),e._destroyBars("lineBox"),e._destroyBars("releaseBox"),e._destroyBars("iterationBox"),e._destroyBars("monthBox"),e._destroyBars("monthBox"),e._resetTreeBox(e),e._calcTimeStats(),e._drawMonthBars(),e._renderTimeboxes(),e._addMilestoneBox(e);var n=Ext.getCmp("lineBox"),r=Ext.getCmp("treeBox");n.suspendLayout=!0,r.suspendLayout=!0,_.each(a,function(t){var a=t.get("PlannedStartDate"),i=t.get("PlannedEndDate"),l=t.get("ActualStartDate"),o=t.get("ActualEndDate"),s=a?l&&a<l?l:a:l||null,d=i?o&&i<o?o:i:o||null;(!e.getSetting("disableOutOfDateRange")||s&&d)&&(tlbox=e._createTimeLineForItem(e,t),n.add(tlbox),ttbox=e._createTitleBoxForItem(e,t),e._dataCheckItem(e,ttbox,t),r.add(ttbox))});var l=Ext.getCmp("parentBox");if(l){var o=_.uniq(_.map(a,function(e){return e.get("Parent")?e.get("Parent")._refObjectName:"Unknown"}));_.each(o,function(t){var i=_.filter(a,function(e){return(e.get("Parent")?e.get("Parent")._refObjectName:"Unknown")===t}),n={};n.height=nantonelliTimeLineApp.TimeLineBarHeight*i.length,n.colour=e.paleColours[_.indexOf(o,t)%e.paleColours.length],n.title=t,l.add(e._createBar(n))})}n.suspendLayout=!1,r.suspendLayout=!1,n.updateLayout(),r.updateLayout(),e._addLines()},scope:e}})},_addLines:function(){this._addLine("Today",new Date,"today"),this._addMilestones()},_createTitleBoxForItem:function(e,t){var a={};a.colour=nantonelliTimeLineApp.HdrColour,a.leftMargin=0,a.width="100%",a.title=t.get("FormattedID")+": "+t.get("Name");var i=e._createBar(a);return i.addCls("tltBox"),i},_createTimeLineForItem:function(e,t){var a=new Date,i=Ext.create("Ext.container.Container",{id:"timeLineBox-"+t.get("FormattedID")});i.addCls("tlBox"),i.height=nantonelliTimeLineApp.TimeLineBarHeight;var n={};n.colour=nantonelliTimeLineApp.HdrColour,n.width=0,n.height=Math.floor(nantonelliTimeLineApp.TimeLineBarHeight/2),n.leftMargin=0;var r=null,l=null,o=null,s=null;t.get("PlannedStartDate")&&t.get("PlannedEndDate")?(r=new Date(t.get("PlannedStartDate")),l=new Date(t.get("PlannedEndDate")),o=Ext.Date.between(r,stats.start,stats.end),s=Ext.Date.between(l,stats.start,stats.end),!o&&s?(n.leftMargin=0,n.width=Ext.Date.getElapsed(stats.start,l)*stats.pixelsPerDay/864e5):o&&!s?(n.leftMargin=Ext.Date.getElapsed(stats.start,r)*stats.pixelsPerDay/864e5,n.width=Ext.Date.getElapsed(r,stats.end)*stats.pixelsPerDay/864e5):o&&s&&(n.leftMargin=Ext.Date.getElapsed(stats.start,r)*stats.pixelsPerDay/864e5,n.width=Ext.Date.getElapsed(r,l)*stats.pixelsPerDay/864e5)):n.colour=nantonelliTimeLineApp.DataError;var d=e._createBar(n);d.addCls("planBar");d.record=t,d.tooltip=e._addTipInfo(d,[{text:"Planned Start Date",field:"PlannedStartDate"},{text:"Planned End Date",field:"PlannedEndDate"}]),i.add(d);var p={},g=0;g=e.getSetting("percentageType")?Math.floor(100*t.get("PercentDoneByStoryPlanEstimate")):Math.floor(100*t.get("PercentDoneByStoryCount")),p.colour=nantonelliTimeLineApp.PassColour,p.height=Math.floor(nantonelliTimeLineApp.TimeLineBarHeight/2),p.leftMargin=0,p.width=0;var u=new Date(t.get("ActualStartDate")),c=new Date(t.get("ActualEndDate"));if(t.get("ActualStartDate")&&t.get("ActualEndDate"))p.colour=nantonelliTimeLineApp.DoneColour,p.title=g+"%",p.leftMargin=Ext.Date.getElapsed(stats.start,u)*stats.pixelsPerDay/864e5,p.width=Ext.Date.getElapsed(u,c)*stats.pixelsPerDay/864e5;else{t.get("ActualStartDate")?(p.title=g+"%",colourStart=t.get("ActualStartDate")):t.get("PlannedEndDate")?colourStart=t.get("PlannedStartDate"):colourStart=a,t.get("ActualEndDate")?colourEnd=t.get("ActualEndDate"):t.get("PlannedEndDate")?colourEnd=t.get("PlannedEndDate"):colourEnd=a;var h=colourEnd-colourStart,x=.2*h,m=.2*h;colourStartDate=new Date(colourStart),colourEndDate=new Date(colourEnd),yellowXStart=Ext.Date.add(colourStartDate,Ext.Date.MILLI,x),redXStart=Ext.Date.add(colourStartDate,Ext.Date.MILLI,x+m),yellowSlope=100/(colourEnd-yellowXStart),redSlope=100/(colourEnd-redXStart),redThreshold=redSlope*(a-redXStart),yellowThreshold=yellowSlope*(a-yellowXStart),g<redThreshold&&(p.colour=nantonelliTimeLineApp.ErrorColour),g<yellowThreshold&&(p.colour=nantonelliTimeLineApp.WarnColour),a>colourEnd&&(p.colour=g>=100?nantonelliTimeLineApp.DoneColour:nantonelliTimeLineApp.ErrorColour),o=Ext.Date.between(u,stats.start,stats.end),s=Ext.Date.between(c,stats.start,stats.end),!o&&s?(p.leftMargin=0,p.width=Ext.Date.getElapsed(stats.start,c||a)*stats.pixelsPerDay/864e5):o&&!s?(p.leftMargin=Ext.Date.getElapsed(stats.start,u)*stats.pixelsPerDay/864e5,p.width=Ext.Date.getElapsed(u,t.get("ActualEndDate")?stats.end:a)*stats.pixelsPerDay/864e5):o&&s&&(p.leftMargin=Ext.Date.getElapsed(stats.start,u)*stats.pixelsPerDay/864e5,p.width=Ext.Date.getElapsed(u,t.get("ActualEndDate")?c:a)*stats.pixelsPerDay/864e5)}var y=e._createBar(p);y.addCls("actualBar"),y.record=t;return y.record=t,y.tooltip=e._addTipInfo(y,[{text:"Actual Start Date",field:"ActualStartDate"},{text:"Actual End Date",field:"ActualEndDate"}]),i.add(y),i},_calcTimeStats:function(){stats={},stats.start=new Date(Ext.Date.getFirstDateOfMonth(Ext.getCmp("StartDate").value)),stats.end=new Date(Ext.Date.getLastDateOfMonth(Ext.getCmp("EndDate").value)),stats.daysDuration=(stats.end-stats.start)/864e5,stats.daysDuration=stats.daysDuration>31?stats.daysDuration:31;var e=this.self.ChildBoxWidth;this.getSetting("groupByParent")&&(e=this.self.ChildBoxWidth+this.self.ParentBoxWidth);var t=(Ext.getBody().getWidth()-e)/(stats.daysDuration>0?stats.daysDuration:1)*this.zoomLevel;return stats.pixelsPerDay=t>1?t:1,stats},_addMilestoneBox:function(e){var t=Ext.getCmp("lineBox"),a=Ext.create("Ext.container.Container",{width:stats.daysDuration*stats.pixelsPerDay,height:"10px",id:"milestoneBox",cls:"milestoneboxcls"});a.addCls("mlbox"),t.add(a)},_drawMonthBars:function(){var e={},t=Ext.getCmp("monthBox");monthNum=stats.start.getMonth();for(var a=stats.start;a<=stats.end;){e.title=Ext.Date.format(a,"M Y"),e.colour=nantonelliTimeLineApp.HdrColour,e.width=this.self.DaysPerMonth[monthNum]*stats.pixelsPerDay,e.height=nantonelliTimeLineApp.HeaderBoxHeight;var i=this._createBar(e);i.addCls("mnthBox"),t.add(i),a=Ext.Date.add(a,Ext.Date.MONTH,1),monthNum+=1,monthNum>11&&(monthNum=0)}},_createBar:function(e){var t="0 0 0 "+(e.leftMargin||0);t=e.margin||t;var a=Ext.create("Rally.app.CustomTimeLineBar",{id:"TimeLineBar-"+Ext.id(),margin:t,html:e.title||"",width:e.width,height:e.height||nantonelliTimeLineApp.TimeLineBarHeight});return a.setStyle({backgroundColor:e.colour,textAlign:e.align||"center"}),a.tooltip=e.tooltip,a}});
                Ext.define("Rally.app.CustomTimeLineBar",{extend:"Ext.Component",alias:"widget.timeLineBar",constructor:function(e){this.mergeConfig(e),this.callParent(arguments)},config:{autoSize:!0,viewBox:!1,draggable:!1,height:nantonelliTimeLineApp.TimeLineBarHeight,style:{font:"9px Helvetica, sans-serif",backgroundColor:nantonelliTimeLineApp.HdrColour}},listeners:{afterrender:function(e,t){this.tooltip&&Ext.create("Rally.ui.tooltip.ToolTip",{target:this.getEl(),html:this.tooltip})}}});

            Rally.launchApp('nantonelliTimeLineApp', {
                name:"TimeLine",
                parentRepos:"",
                version:"0.1.1"
            });

        });
    </script>


    <style type="text/css">
        .tlBox{border-bottom:1px solid #00A9E0;height:30px}.milestoneboxcls{background-color:#00A9E0}.planBar{background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAPCAYAAAACsSQRAAAEDWlDQ1BJQ0MgUHJvZmlsZQAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VVBg/m8AAAAjSURBVDgRY/wPBAwUAiYK9YO1Dx5DqOGbUTOGfwgwDq+8AwBhUggFKcv2KQAAAABJRU5ErkJggg==');background-repeat:repeat-x;margin-top:5px;z-index:2}.actualBar{background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAPCAYAAAACsSQRAAAEDWlDQ1BJQ0MgUHJvZmlsZQAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VVBg/m8AAAAjSURBVDgRY/wPBAwUAiYK9YO1Dx5DqOGbUTOGfwgwDq+8AwBhUggFKcv2KQAAAABJRU5ErkJggg==');height:10px;padding-bottom:5px;z-index:2;border-bottom:1px solid #00A9E0}.tltBox{border-bottom:1px solid #FFFFFF}.mnthBox{border-left:1px solid #999999}.mlbox{z-index:10}.errorCorner{background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAEDWlDQ1BJQ0MgUHJvZmlsZQAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VVBg/m8AAAA5SURBVBgZY/zPwABEhAEjSAkxisEKiVEMV0hIMYpCfIoxFOJSjFUhNsU4FaIrxqsQXTGIjxeAwhkA/x0T9gDAanEAAAAASUVORK5CYII=');background-repeat:no-repeat;background-position:right top}.todayIcon{background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAEDWlDQ1BJQ0MgUHJvZmlsZQAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VVBg/m8AAAA6SURBVBgZY2RgYPgPxAQBE0EVUAWMUJqQqYwkmwgyGJepYFvJMhGbqTA/MBBtItTTKBTIrRjuJdpEANf+BgyegZ+UAAAAAElFTkSuQmCC')}.todayLine{border:1px solid #000000}.projectMlsIcon{background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAEDWlDQ1BJQ0MgUHJvZmlsZQAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VVBg/m8AAABLSURBVBgZjY7RCgAgCAOz///napEyR4h7ktsxtHUyGpnq2IvyJMJxgW+wELVAmVjnRzixiIUqV6xWvYtFB7zKLEQIXPCNzhQA/rIBthYoAU7mS/IAAAAASUVORK5CYII=')}.projectMlsLine{border-width:2px;border-style:none dashed none none}.globalMlsIcon{background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAEDWlDQ1BJQ0MgUHJvZmlsZQAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VVBg/m8AAABLSURBVBgZjY7RCgAgCAOz///napEyR4h7ktsxtHUyGpnq2IvyJMJxgW+wELVAmVjnRzixiIUqV6xWvYtFB7zKLEQIXPCNzhQA/rIBthYoAU7mS/IAAAAASUVORK5CYII=')}.globalMlsLine{border-width:2px;border-style:none dotted none none}.overlayLine{position:absolute;left:0px;top:0px}
    </style>
</head>
<body>
</body>
</html>
