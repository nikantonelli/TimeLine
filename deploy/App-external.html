<!DOCTYPE html>
<html>
<head>
    <title>TimeLine</title>

    <script type="text/javascript" src="https://rally1.rallydev.com/apps/2.1/sdk.js"></script>

    <script type="text/javascript">
        Rally.onReady(function () {
                Ext.define("nantonelliTimeLineApp",{extend:"Rally.app.App",componentCls:"app",id:"MyApp",paleColours:["#E4EECF","#E6E6E6","#BDD7EA","#FFEDBF","#6ab17d","#F1C5DD","#C3E9E3"],inheritableStatics:{ErrorColour:Rally.util.Colors.red_med,WarnColour:Rally.util.Colors.yellow,PassColour:Rally.util.Colors.lime,DoneColour:"silver",ToDoColour:Rally.util.Colors.cyan_very_lt,HdrColour:"lightgray",DataError:"red",DaysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],ChildBoxWidth:300,ParentBoxWidth:200,TimeLineBarHeight:30,HeaderBoxHeight:15,MileStoneBoxColour:"#00A9E0"},items:[{xtype:"container",layout:"hbox",items:[{xtype:"container",id:"headerBox",flex:1,layout:"hbox",items:[{xtype:"rallydatefield",margin:10,format:"D d M Y",id:"StartDate",stateful:!0,fieldLabel:"Start Date",value:Ext.Date.subtract(new Date,Ext.Date.DAY,90)},{xtype:"rallydatefield",margin:10,fieldLabel:"End Date",format:"D d M Y",stateful:!0,id:"EndDate",value:new Date}]},{xtype:"container",layout:"hbox",margin:10,items:[{xtype:"rallybuttonslider",labelText:"Zoom",id:"zoomSlider",stateful:!0,value:10}]}]}],getSettingsFields:function(){var returnVal=[{xtype:"rallycheckboxfield",name:"percentageType",fieldLabel:"Use story points for percentages",stateful:!0,stateId:"percent-"+Ext.id(),labelAlign:"right",labelWidth:200},{xtype:"rallycheckboxfield",name:"displayIterations",fieldLabel:"Display Iteration Header",stateful:!0,stateId:"dispIters-"+Ext.id(),labelAlign:"right",labelWidth:200},{xtype:"rallycheckboxfield",name:"displayReleases",fieldLabel:"Display Release Header",stateful:!0,stateId:"dispRels-"+Ext.id(),labelAlign:"right",labelWidth:200},{xtype:"rallycheckboxfield",name:"updateForRelease",fieldLabel:"Auto update to Release",stateful:!0,stateId:"dduRels-"+Ext.id(),labelAlign:"right",labelWidth:200},{xtype:"rallycheckboxfield",name:"groupByParent",fieldLabel:"Group Portfolio Items",stateful:!0,stateId:"groupByPs-"+Ext.id(),labelAlign:"right",labelWidth:200},{xtype:"rallycheckboxfield",name:"enableOutOfDateRange",fieldLabel:"Enable Out of Range Dates",stateful:!0,stateId:"enablr-"+Ext.id(),labelAlign:"right",labelWidth:200},{xtype:"textarea",fieldLabel:"Query",name:"query",anchor:"100%",cls:"query-field",margin:"0 70 0 0",plugins:[{ptype:"rallyhelpfield",helpId:194},"rallyfieldvalidationui"],validateOnBlur:!1,validateOnChange:!1,validator:function(value){try{return value&&Rally.data.wsapi.Filter.fromQueryString(value),!0}catch(e){return e.message}}}];return returnVal},zoomLevel:1,_resetTreeBox:function(app){var tb=Ext.getCmp("treeBox"),pb=Ext.getCmp("parentBox");app._destroyBars(tb.id),tb.add(app._createBar({title:"Calendar Month:",colour:nantonelliTimeLineApp.HdrColour,width:"100%",margin:"0 0 10 0",height:nantonelliTimeLineApp.HeaderBoxHeight,align:"right"})),pb&&(app._destroyBars(pb.id),pb.add(app._createBar({colour:nantonelliTimeLineApp.HdrColour,width:"100%",margin:"0 0 10 0",height:nantonelliTimeLineApp.HeaderBoxHeight,align:"right"})))},_destroyBars:function(boxTitle){var box=Ext.getCmp(boxTitle);box&&box.removeAll()},_resizeAllBars:function(){this._redrawTimeLines(this,Ext.getCmp("piType").getRecord().get("TypePath"))},_addTipInfo:function(box,tooltipfields){var record=box.record,html="";return _.each(tooltipfields,function(tip){var typeOfField=Object.prototype.toString.call(record.get(tip.field));html+=typeOfField.search("Date")?"<div><strong>"+tip.text+": </strong>"+Ext.Date.format(record.get(tip.field),"D d M Y (T)")+"</div>":"<div><strong>"+tip.text+": </strong>"+record.get(tip.field)+"</div>"}),html.length>0?html:null},_renderTimeboxes:function(){this._iterationRender(),this._releaseRender()},_iterationRender:function(){if(this.getSetting("displayIterations")){var title="Sprint: ",tb=Ext.getCmp("treeBox"),titleBox=this._createBar({width:"100%",height:nantonelliTimeLineApp.HeaderBoxHeight,title:title,colour:nantonelliTimeLineApp.HdrColour,align:"right"});tb.insert(0,titleBox);var pb=Ext.getCmp("parentBox");if(pb){var blankBox=this._createBar({width:"100%",height:nantonelliTimeLineApp.HeaderBoxHeight,title:"",colour:nantonelliTimeLineApp.HdrColour,align:"right"});pb.insert(0,blankBox)}var tipFields=[{text:"Iteration Start Date",field:"StartDate"},{text:"Iteration End Date",field:"EndDate"}];this._timeboxRender("iteration","StartDate","EndDate",title,tipFields)}},_releaseRender:function(){if(this.getSetting("displayReleases")){var title="Program Increment: ",tb=Ext.getCmp("treeBox"),titleBox=this._createBar({width:"100%",height:nantonelliTimeLineApp.HeaderBoxHeight,title:title,colour:nantonelliTimeLineApp.HdrColour,align:"right"});tb.insert(0,titleBox);var pb=Ext.getCmp("parentBox");if(pb){var blankBox=this._createBar({width:"100%",height:nantonelliTimeLineApp.HeaderBoxHeight,title:"",colour:nantonelliTimeLineApp.HdrColour,align:"right"});pb.insert(0,blankBox)}var tipFields=[{text:"Release Start Date",field:"ReleaseStartDate"},{text:"Release End Date",field:"ReleaseDate"}];this._timeboxRender("release","ReleaseStartDate","ReleaseDate",title,tipFields)}},_timeboxRender:function(model,startdatefield,enddatefield,title,tooltipfields){var app=this,dataStore=Ext.create("Rally.data.wsapi.Store",{model:model,autoLoad:!0,context:{project:Rally.environment.getContext().getProjectRef(),projectScopeUp:!1,projectScopeDown:!1},sorters:[{property:enddatefield,direction:"ASC"}],listeners:{load:function(store,data,success){var timeBox=Ext.getCmp(model+"Box"),boxes=[],srd=data[0].get(startdatefield);if(srd>stats.start){var startBox={width:Ext.Date.getElapsed(srd,stats.start)*stats.pixelsPerDay/864e5,start:stats.start,leftMargin:0,end:srd,colour:nantonelliTimeLineApp.ToDoColour,height:nantonelliTimeLineApp.HeaderBoxHeight};boxes.push(startBox)}_.each(data,function(tb){var thisStart=Ext.Date.clearTime(tb.get(startdatefield)),thisEnd=Ext.Date.clearTime(Ext.Date.add(tb.get(enddatefield),Ext.Date.HOUR,1));if((lastBox=boxes[boxes.length-1])&&lastBox.end!=thisStart){var spacerBox={width:Ext.Date.getElapsed(lastBox.end,thisStart)*stats.pixelsPerDay/864e5,start:lastBox.end,leftMargin:0,end:thisStart,colour:nantonelliTimeLineApp.ToDoColour,height:nantonelliTimeLineApp.HeaderBoxHeight};boxes.push(spacerBox)}var box={width:Ext.Date.getElapsed(thisEnd,thisStart)*stats.pixelsPerDay/864e5,leftMargin:0,start:thisStart,end:thisEnd,colour:nantonelliTimeLineApp.HdrColour,title:tb.get("Name"),height:nantonelliTimeLineApp.HeaderBoxHeight,record:tb};box.tooltip=app._addTipInfo(box,tooltipfields),boxes.push(box)});var erd=boxes[boxes.length-1].end;if(erd<stats.end){var endBox={width:Ext.Date.getElapsed(erd,stats.end)*stats.pixelsPerDay/864e5,start:erd,leftMargin:0,end:stats.end,colour:nantonelliTimeLineApp.ToDoColour,height:nantonelliTimeLineApp.HeaderBoxHeight};boxes.push(endBox)}_.each(boxes,function(box){if(!(box.end<stats.start||box.start>stats.end)){box.start<stats.start&&(box.start=stats.start,box.start>=box.end?box.width=0:box.width=Ext.Date.getElapsed(box.end,box.start)*stats.pixelsPerDay/864e5),box.end>stats.end&&(box.end=stats.end,box.end<=box.start?box.width=0:box.width=Ext.Date.getElapsed(box.end,box.start)*stats.pixelsPerDay/864e5);var theBar=app._createBar(box);theBar.addCls("mnthBox"),theBar.addCls("tltBox"),timeBox.add(theBar)}})}}})},launch:function(){var app=this,slider=Ext.getCmp("zoomSlider"),lb=slider.getLeftButton(),rb=slider.getRightButton(),sl=slider.getSlider();rb.on("click",function(){app.zoomLevel+=1,app.zoomLevel>10&&(app.zoomLevel=10),sl.setValue(10*app.zoomLevel),app._redrawTimeLines(app,Ext.getCmp("piType").getRecord().get("TypePath"))}),lb.on("click",function(){app.zoomLevel-=1,app.zoomLevel<=0&&(app.zoomLevel=1),sl.setValue(10*app.zoomLevel),app._redrawTimeLines(app,Ext.getCmp("piType").getRecord().get("TypePath"))}),sl.on("changecomplete",function(slider,value,that){app.zoomLevel=Math.trunc(value/10),app._redrawTimeLines(app,Ext.getCmp("piType").getRecord().get("TypePath"))}),Ext.getCmp("StartDate").on("select",app._resizeAllBars,app),Ext.getCmp("EndDate").on("select",app._resizeAllBars,app);var hboxItems=[{xtype:"container",id:"treeBox",width:this.self.ChildBoxWidth-4,margin:"0 0 0 0"},{xtype:"container",id:"scrollBox",layout:"vbox",items:[{xtype:"container",id:"releaseBox",layout:"hbox"},{xtype:"container",id:"iterationBox",layout:"hbox"},{xtype:"container",id:"monthBox",layout:"hbox"},{xtype:"container",autoSize:!0,id:"lineBox"}],flex:1,style:{overflowX:"scroll",overflowY:"visible"}}];app.getSetting("groupByParent")&&hboxItems.splice(0,0,{xtype:"container",id:"parentBox",width:this.self.ParentBoxWidth-4,margin:"0 0 0 0"});var timeLineBox=Ext.create("Ext.container.Container",{layout:"hbox",items:hboxItems});this.add(timeLineBox);var pitype=Ext.getCmp("piType");pitype||(pitype=Ext.create("Rally.ui.combobox.PortfolioItemTypeComboBox",{margin:10,id:"piType",listeners:{select:function(){app._redrawTimeLines(app,Ext.getCmp("piType").getRecord().get("TypePath"))}}})),Ext.getCmp("headerBox").insert(0,pitype)},onTimeboxScopeChange:function(newScope){this.callParent(arguments);var app=this;if("release"==newScope.type){var release=newScope.getRecord();this.getSetting("updateForRelease")?(Ext.getCmp("StartDate").setValue(release.get("ReleaseStartDate")),Ext.getCmp("EndDate").setValue(release.get("ReleaseDate")),app._redrawTimeLines(app,Ext.getCmp("piType").getRecord().get("TypePath"))):Ext.create("Rally.ui.dialog.ConfirmDialog",{message:"Update view dates to match Release?",title:"Timebox Scope Change Request",confirmLabel:"Ok",listeners:{confirm:function(){Ext.getCmp("StartDate").setValue(release.get("ReleaseStartDate")),Ext.getCmp("EndDate").setValue(release.get("ReleaseDate")),app._redrawTimeLines(app,Ext.getCmp("piType").getRecord().get("TypePath"))},cancel:function(){app._redrawTimeLines(app,Ext.getCmp("piType").getRecord().get("TypePath"))}}})}},_dataCheckItem:function(app,box,item){var fail=!1,html="";item.self.isPortfolioItem()&&(item.get("PlannedStartDate")||(fail=!0,html+="<div><strong> Missing Planned Start Date</strong></div>"),item.get("PlannedEndDate")||(fail=!0,html+="<div><strong> Missing Planned End Date</strong></div>")),fail&&(box.addCls("errorCorner"),box.tooltip=html)},_addToday:function(app){var msbox=Ext.getCmp("milestoneBox"),linebox=Ext.getCmp("lineBox"),margin="0 0 0 "+(Ext.Date.getElapsed(stats.start,new Date)*stats.pixelsPerDay/864e5-4);todayIcon=Ext.create("Ext.container.Container",{height:"10px",width:"10px",style:{backgroundColor:nantonelliTimeLineApp.MileStoneBoxColour},margin:margin,listeners:{afterrender:function(){Ext.create("Rally.ui.tooltip.ToolTip",{target:this.getEl(),html:"Today: "+Ext.Date.format(new Date,"D, d M Y")})}}}),todayIcon.addCls("todayIcon"),msbox.add(todayIcon),todayLine=Ext.create("Ext.container.Container",{height:linebox.getHeight(),width:"1px",border:1,style:{borderColor:"#000000",borderStyle:"solid",backgroundColor:"#000000"},margin:"0 0 0 "+Ext.Date.getElapsed(stats.start,new Date)*stats.pixelsPerDay/864e5}),todayLine.addCls("todayLine"),msbox.add(todayLine)},_redrawTimeLines:function(app,type){var filters=[],timeboxScope=app.getContext().getTimeboxScope();timeboxScope&&filters.push(timeboxScope.getQueryFilter());var queryString=app.getSetting("query");if(queryString){var filterObj=Rally.data.wsapi.Filter.fromQueryString(queryString);filterObj.itemId=filterObj.toString(),filters.push(filterObj)}var sorter=null;sorter=app.getSetting("groupByParent")?{property:"Parent",direction:"ASC"}:{property:"rank",direction:"ASC"};var visibleFilter=Ext.create("Rally.data.wsapi.Filter",{property:"Archived",operator:"=",value:!1});filters.push(visibleFilter);var itemStore=Ext.create("Rally.data.wsapi.Store",{model:type,autoLoad:!0,filters:filters,sorters:[sorter],listeners:{load:function(store,data,success){app._destroyBars("lineBox"),app._destroyBars("releaseBox"),app._destroyBars("iterationBox"),app._destroyBars("monthBox"),app._destroyBars("monthBox"),app._resetTreeBox(app),app._calcTimeStats(),app._drawMonthBars(),app._renderTimeboxes(),app._addMilestoneBox(app);var timeLineBox=Ext.getCmp("lineBox"),treeBox=Ext.getCmp("treeBox");timeLineBox.suspendLayout=!0,treeBox.suspendLayout=!0,_.each(data,function(item){var startPD=item.get("PlannedStartDate"),endPD=item.get("PlannedEndDate"),startAD=item.get("ActualStartDate"),endAD=item.get("ActualEndDate"),gotSDate=startPD?startAD&&startPD<startAD?startAD:startPD:startAD?startAD:null,gotEDate=endPD?endAD&&endPD<endAD?endAD:endPD:endAD?endAD:null;(!app.getSetting("disableOutOfDateRange")||gotSDate&&gotEDate)&&(tlbox=app._createTimeLineForItem(app,item),timeLineBox.add(tlbox),ttbox=app._createTitleBoxForItem(app,item),app._dataCheckItem(app,ttbox,item),treeBox.add(ttbox))});var pb=Ext.getCmp("parentBox");if(pb){var uniqs=_.uniq(_.map(data,function(record){return record.get("Parent")?record.get("Parent")._refObjectName:"Unknown"}));_.each(uniqs,function(parent){var found=_.filter(data,function(record){return(record.get("Parent")?record.get("Parent")._refObjectName:"Unknown")===parent}),parentBox={};parentBox.height=nantonelliTimeLineApp.TimeLineBarHeight*found.length,parentBox.colour=app.paleColours[_.indexOf(uniqs,parent)%app.paleColours.length],parentBox.title=parent,pb.add(app._createBar(parentBox))})}timeLineBox.suspendLayout=!1,treeBox.suspendLayout=!1,timeLineBox.updateLayout(),treeBox.updateLayout(),app._addToday(app)}}})},_createTitleBoxForItem:function(app,item){var titleRec={};titleRec.colour=nantonelliTimeLineApp.HdrColour,titleRec.leftMargin=0,titleRec.width="100%",titleRec.title=item.get("FormattedID")+": "+item.get("Name");var box=app._createBar(titleRec);return box.addCls("tltBox"),box},_createTimeLineForItem:function(app,item){var today=new Date,box=Ext.create("Ext.container.Container",{id:"timeLineBox-"+item.get("FormattedID")});box.addCls("tlBox"),box.height=nantonelliTimeLineApp.TimeLineBarHeight;var pRecord={};pRecord.colour=nantonelliTimeLineApp.HdrColour,pRecord.width=0,pRecord.height=Math.floor(nantonelliTimeLineApp.TimeLineBarHeight/2),pRecord.leftMargin=0;var plannedStart=null,plannedEnd=null,startBetween=null,endBetween=null;item.get("PlannedStartDate")&&item.get("PlannedEndDate")?(plannedStart=new Date(item.get("PlannedStartDate")),plannedEnd=new Date(item.get("PlannedEndDate")),startBetween=Ext.Date.between(plannedStart,stats.start,stats.end),endBetween=Ext.Date.between(plannedEnd,stats.start,stats.end),!startBetween&&endBetween?(pRecord.leftMargin=0,pRecord.width=Ext.Date.getElapsed(stats.start,plannedEnd)*stats.pixelsPerDay/864e5):startBetween&&!endBetween?(pRecord.leftMargin=Ext.Date.getElapsed(stats.start,plannedStart)*stats.pixelsPerDay/864e5,pRecord.width=Ext.Date.getElapsed(plannedStart,stats.end)*stats.pixelsPerDay/864e5):startBetween&&endBetween&&(pRecord.leftMargin=Ext.Date.getElapsed(stats.start,plannedStart)*stats.pixelsPerDay/864e5,pRecord.width=Ext.Date.getElapsed(plannedStart,plannedEnd)*stats.pixelsPerDay/864e5)):pRecord.colour=nantonelliTimeLineApp.DataError;var plannedBar=app._createBar(pRecord);plannedBar.addCls("planBar");var tipFields=[{text:"Planned Start Date",field:"PlannedStartDate"},{text:"Planned End Date",field:"PlannedEndDate"}];plannedBar.record=item,plannedBar.tooltip=app._addTipInfo(plannedBar,tipFields),box.add(plannedBar);var aRecord={},percentComplete=0;percentComplete=app.getSetting("percentageType")?Math.floor(100*item.get("PercentDoneByStoryPlanEstimate")):Math.floor(100*item.get("PercentDoneByStoryCount")),aRecord.colour=nantonelliTimeLineApp.PassColour,aRecord.height=Math.floor(nantonelliTimeLineApp.TimeLineBarHeight/2),aRecord.leftMargin=0,aRecord.width=0;var actualStart=new Date(item.get("ActualStartDate")),actualEnd=new Date(item.get("ActualEndDate"));if(item.get("ActualStartDate")&&item.get("ActualEndDate"))aRecord.colour=nantonelliTimeLineApp.DoneColour,aRecord.title=percentComplete+"%",aRecord.leftMargin=Ext.Date.getElapsed(stats.start,actualStart)*stats.pixelsPerDay/864e5,aRecord.width=Ext.Date.getElapsed(actualStart,actualEnd)*stats.pixelsPerDay/864e5;else{item.get("ActualStartDate")?(aRecord.title=percentComplete+"%",colourStart=item.get("ActualStartDate")):item.get("PlannedEndDate")?colourStart=item.get("PlannedStartDate"):colourStart=today,item.get("ActualEndDate")?colourEnd=item.get("ActualEndDate"):item.get("PlannedEndDate")?colourEnd=item.get("PlannedEndDate"):colourEnd=today;var totalElapsed=colourEnd-colourStart,acceptanceDelay=.2*totalElapsed,warningDelay=.2*totalElapsed;colourStartDate=new Date(colourStart),colourEndDate=new Date(colourEnd),yellowXStart=Ext.Date.add(colourStartDate,Ext.Date.MILLI,acceptanceDelay),redXStart=Ext.Date.add(colourStartDate,Ext.Date.MILLI,acceptanceDelay+warningDelay),yellowSlope=100/(colourEnd-yellowXStart),redSlope=100/(colourEnd-redXStart),redThreshold=redSlope*(today-redXStart),yellowThreshold=yellowSlope*(today-yellowXStart),percentComplete<redThreshold&&(aRecord.colour=nantonelliTimeLineApp.ErrorColour),percentComplete<yellowThreshold&&(aRecord.colour=nantonelliTimeLineApp.WarnColour),today>colourEnd&&(percentComplete>=100?aRecord.colour=nantonelliTimeLineApp.DoneColour:aRecord.colour=nantonelliTimeLineApp.ErrorColour),startBetween=Ext.Date.between(actualStart,stats.start,stats.end),endBetween=Ext.Date.between(actualEnd,stats.start,stats.end),!startBetween&&endBetween?(aRecord.leftMargin=0,aRecord.width=Ext.Date.getElapsed(stats.start,actualEnd?actualEnd:today)*stats.pixelsPerDay/864e5):startBetween&&!endBetween?(aRecord.leftMargin=Ext.Date.getElapsed(stats.start,actualStart)*stats.pixelsPerDay/864e5,aRecord.width=Ext.Date.getElapsed(actualStart,item.get("ActualEndDate")?stats.end:today)*stats.pixelsPerDay/864e5):startBetween&&endBetween&&(aRecord.leftMargin=Ext.Date.getElapsed(stats.start,actualStart)*stats.pixelsPerDay/864e5,aRecord.width=Ext.Date.getElapsed(actualStart,item.get("ActualEndDate")?actualEnd:today)*stats.pixelsPerDay/864e5)}var actualBar=app._createBar(aRecord);actualBar.addCls("actualBar"),actualBar.record=item;var actualsFields=[{text:"Actual Start Date",field:"ActualStartDate"},{text:"Actual End Date",field:"ActualEndDate"}];return actualBar.record=item,actualBar.tooltip=app._addTipInfo(actualBar,actualsFields),box.add(actualBar),box},_calcTimeStats:function(){stats={},stats.start=new Date(Ext.Date.getFirstDateOfMonth(Ext.getCmp("StartDate").value)),stats.end=new Date(Ext.Date.getLastDateOfMonth(Ext.getCmp("EndDate").value)),stats.daysDuration=(stats.end-stats.start)/864e5,stats.daysDuration=stats.daysDuration>31?stats.daysDuration:31;var itemsWidth=this.self.ChildBoxWidth;this.getSetting("groupByParent")&&(itemsWidth=this.self.ChildBoxWidth+this.self.ParentBoxWidth);var pixelsPerDay=(Ext.getBody().getWidth()-itemsWidth)/(stats.daysDuration>0?stats.daysDuration:1)*this.zoomLevel;return stats.pixelsPerDay=pixelsPerDay>1?pixelsPerDay:1,stats},_addMilestoneBox:function(app){var lineBox=Ext.getCmp("lineBox"),milestoneBox=Ext.create("Ext.container.Container",{width:stats.daysDuration*stats.pixelsPerDay,height:"10px",id:"milestoneBox",style:{backgroundColor:nantonelliTimeLineApp.MileStoneBoxColour}});milestoneBox.addCls("mlbox"),lineBox.add(milestoneBox)},_drawMonthBars:function(){var record={},monthBox=Ext.getCmp("monthBox");monthNum=stats.start.getMonth();for(var lDate=stats.start,lDays=0;lDate<=stats.end;){record.title=Ext.Date.format(lDate,"M Y"),record.colour=nantonelliTimeLineApp.HdrColour,record.width=this.self.DaysPerMonth[monthNum]*stats.pixelsPerDay,record.height=nantonelliTimeLineApp.HeaderBoxHeight;var mnth=this._createBar(record);mnth.addCls("mnthBox"),monthBox.add(mnth),lDate=Ext.Date.add(lDate,Ext.Date.MONTH,1),monthNum+=1,monthNum>11&&(monthNum=0)}},_createBar:function(record){var margin="0 0 0 "+(record.leftMargin||0);margin=record.margin||margin;var bar=Ext.create("Rally.app.CustomTimeLineBar",{id:"TimeLineBar-"+Ext.id(),margin:margin,html:record.title||"",width:record.width,height:record.height||nantonelliTimeLineApp.TimeLineBarHeight});return bar.setStyle({backgroundColor:record.colour,textAlign:record.align||"center"}),bar.tooltip=record.tooltip,bar}});
                Ext.define("Rally.app.CustomTimeLineBar",{extend:"Ext.Component",alias:"widget.timeLineBar",constructor:function(config){this.mergeConfig(config),this.callParent(arguments)},config:{autoSize:!0,viewBox:!1,draggable:!1,height:nantonelliTimeLineApp.TimeLineBarHeight,style:{font:"9px Helvetica, sans-serif",backgroundColor:nantonelliTimeLineApp.HdrColour}},listeners:{afterrender:function(arg1,arg2){this.tooltip&&Ext.create("Rally.ui.tooltip.ToolTip",{target:this.getEl(),html:this.tooltip})}}});

            Rally.launchApp('nantonelliTimeLineApp', {
                name:"TimeLine",
	            parentRepos:""
            });

        });
    </script>


    <style type="text/css">
        .tlBox{border-bottom:1px solid #00A9E0;height:30px}.planBar{background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAPCAYAAAACsSQRAAAEDWlDQ1BJQ0MgUHJvZmlsZQAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VVBg/m8AAAAjSURBVDgRY/wPBAwUAiYK9YO1Dx5DqOGbUTOGfwgwDq+8AwBhUggFKcv2KQAAAABJRU5ErkJggg==');background-repeat:repeat-x;margin-top:5px;z-index:2}.actualBar{background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAPCAYAAAACsSQRAAAEDWlDQ1BJQ0MgUHJvZmlsZQAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VVBg/m8AAAAjSURBVDgRY/wPBAwUAiYK9YO1Dx5DqOGbUTOGfwgwDq+8AwBhUggFKcv2KQAAAABJRU5ErkJggg==');height:10px;padding-bottom:5px;z-index:2;border-bottom:1px solid #00A9E0}.tltBox{border-bottom:1px solid #FFFFFF}.mnthBox{border-left:1px solid #999999}.mlbox{z-index:10}.errorCorner{background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAEDWlDQ1BJQ0MgUHJvZmlsZQAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VVBg/m8AAAA5SURBVBgZY/zPwABEhAEjSAkxisEKiVEMV0hIMYpCfIoxFOJSjFUhNsU4FaIrxqsQXTGIjxeAwhkA/x0T9gDAanEAAAAASUVORK5CYII=');background-repeat:no-repeat;background-position:right top}.todayIcon{background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAEDWlDQ1BJQ0MgUHJvZmlsZQAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VVBg/m8AAAA6SURBVBgZY2RgYPgPxAQBE0EVUAWMUJqQqYwkmwgyGJepYFvJMhGbqTA/MBBtItTTKBTIrRjuJdpEANf+BgyegZ+UAAAAAElFTkSuQmCC');z-index:1}.milestoneIcon{background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAEDWlDQ1BJQ0MgUHJvZmlsZQAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VVBg/m8AAABLSURBVBgZjY7RCgAgCAOz///napEyR4h7ktsxtHUyGpnq2IvyJMJxgW+wELVAmVjnRzixiIUqV6xWvYtFB7zKLEQIXPCNzhQA/rIBthYoAU7mS/IAAAAASUVORK5CYII=')}.todayLine{z-index:10}
    </style>
</head>
<body>
</body>
</html>
